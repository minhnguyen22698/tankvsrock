window.__require=function e(t,n,i){function s(r,c){if(!n[r]){if(!t[r]){var a=r.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!c&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+r+"'")}}var h=n[r]={exports:{}};t[r][0].call(h.exports,function(e){return s(t[r][1][e]||e)},h,h.exports,e,t,n,i)}return n[r].exports}for(var o="function"==typeof __require&&__require,r=0;r<i.length;r++)s(i[r]);return s}({1:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(e){return"function"==typeof e}function o(e){return"number"==typeof e}function r(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,o,a,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(c(n=this._events[e]))return!1;if(s(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(r(n))for(o=Array.prototype.slice.call(arguments,1),i=(l=n.slice()).length,a=0;a<i;a++)l[a].apply(this,o);return!0},i.prototype.addListener=function(e,t){var n;if(!s(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,s(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned&&(n=c(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){if(!s(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var n,i,o,c;if(!s(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(n=this._events[e]).length,i=-1,n===t||s(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(n)){for(c=o;c-- >0;)if(n[c]===t||n[c].listener&&n[c].listener===t){i=c;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(s(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?s(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(s(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],Emitter:[function(e,t,n){"use strict";cc._RF.push(t,"02ca7ASgHNLpKMcoUO+O3uP","Emitter");var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=e("events"),r=function(){function e(){s(this,e),this._emitter=new o,this._emitter.setMaxListeners(100)}return i(e,[{key:"emit",value:function(){var e;(e=this._emitter).emit.apply(e,arguments)}},{key:"registerEvent",value:function(e,t){this._emitter.on(e,t)}},{key:"registerOnce",value:function(e,t){this._emitter.once(e,t)}},{key:"removeEvent",value:function(e,t){this._emitter.removeListener(e,t)}},{key:"destroy",value:function(){this._emitter.removeAllListeners(),this._emitter=null,e.instance=null}}]),e}();r.instance=null,t.exports=r,cc._RF.pop()},{events:1}],HelloWorld:[function(e,t,n){"use strict";cc._RF.push(t,"280c3rsZJJKnZ9RqbALVwtK","HelloWorld");var i=e("Emitter");cc.Class({extends:cc.Component,properties:{mainScreen:cc.Node,playScreen:cc.Node,leaderBoardScene:cc.Node},onLoad:function(){i.instance=new i,this.leaderBoardScene.active=!1,i.instance.registerEvent("changeScreen",this.changeRoute.bind(this))},onKeyDown:function(e){i.instance.emit("onMove",e.keyCode)},onKeyUp:function(e){i.instance.emit("stopMove",e.keyCode)},changeRoute:function(e,t){switch(cc.log(e),e){case"mainScreen":cc.log("main"),this.mainScreen.active=!0,this.playScreen.active=!1,this.leaderBoardScene.active=!1;break;case"playScreen":this.mainScreen.active=!1,this.playScreen.active=!0,t&&i.instance.emit("playAgain");break;case"leaderBoardScreen":this.playScreen.active=!1,this.mainScreen.active=!1,this.leaderBoardScene.active=!0}},update:function(e){}}),cc._RF.pop()},{Emitter:"Emitter"}],PlayMain:[function(e,t,n){"use strict";cc._RF.push(t,"9ce72lJXR1GU6my7qPvgMym","PlayMain");var i=e("Emitter");cc.Class({extends:cc.Component,properties:{tank:cc.Node,bullet:cc.Prefab,shootSpeed:1,rock:cc.Prefab,waveLabel:{default:null,type:cc.Label},waveProgress:{default:null,type:cc.ProgressBar},scoreLable:{default:null,type:cc.Label},LosePopUp:cc.Node,_xSpeed:0,_timer:0,_losing:!1,_playScore:{default:0,type:cc.Integer,notify:function(e){this.updateScore(Math.round(e))}},_rockscore:1,_wave:{default:1,type:cc.Integer},_playerArr:[]},onLoad:function(){this.LosePopUp.active=!1,i.instance.registerEvent("save-name",this.onSave.bind(this)),i.instance.registerEvent("updateProgress",this.updateProgress.bind(this)),i.instance.registerEvent("on-losing",this.onLose.bind(this)),i.instance.registerEvent("updateScore",this.updateScore.bind(this)),i.instance.registerEvent("playAgain",this.onPlayAgain.bind(this))},start:function(){this.node.active=!1},updateScore:function(e){this.scoreLable.string=e},onPlayAgain:function(){this.node.opacity=255,this._losing=!1,this._playScore=0,this.wave=1,this.waveProgress.progress=0,this.scoreLable.string=0},updateProgress:function(e){var t=this,n=this._playScore+e;cc.tween(this).to(1,{_playScore:n}).start();var i=this.waveProgress.progress+1/8;cc.tween(this.waveProgress).to(1,{progress:i}).call(function(){1==i&&cc.tween(t.waveProgress).to(1,{progress:0}).call(function(){cc.tween(t.waveLabel.node).to(1,{scale:2}).to(1,{scale:1}).start(),t._wave++,t.waveLabel.string="WAVE "+t._wave}).start()}).start()},onLose:function(){this.node.opacity=100,this.LosePopUp.active=!0,this._losing=!0},dropTheRock:function(){var e=cc.instantiate(this.rock),t=parseInt(this._rockscore);e.getComponent("rock").setScore(t),e.setPosition(200,100),this.node.addChild(e)},shoot:function(){var e=cc.instantiate(this.bullet);e.setPosition(this.tank.x,this.tank.y+100),this.node.addChild(e)},update:function(e){this._losing||(this._xSpeed+=e,this._timer+=e,this._xSpeed>=this.shootSpeed/3&&(this.shoot(),this._xSpeed=0),this._timer>3&&(this._rockscore++,this.dropTheRock(),this._timer=0))},onSave:function(e){var t={name:e,score:this._playScore,wave:this._wave},n=JSON.parse(cc.sys.localStorage.getItem("leaderboard"));null!=n&&(this._playerArr=n),this._playerArr.push(t),cc.log(this._playerArr),cc.sys.localStorage.setItem("leaderboard",JSON.stringify(this._playerArr))}}),cc._RF.pop()},{Emitter:"Emitter"}],bullet:[function(e,t,n){"use strict";cc._RF.push(t,"9ee1fz0QkZGKZjkLwE+Wke+","bullet"),cc.Class({extends:cc.Component,properties:{dame:2},start:function(){var e=this;cc.tween(this.node).to(1,{y:640}).call(function(){e.node.destroy()}).start()},getDame:function(){return this.dame}}),cc._RF.pop()},{}],gameover:[function(e,t,n){"use strict";cc._RF.push(t,"a9feb/+AC5MI63r+27LRohd","gameover");var i=e("Emitter");cc.Class({extends:cc.Component,properties:{titleOver:{default:null,type:cc.Sprite},savedName:{default:null,type:cc.EditBox},btnSave:{default:null,type:cc.Button},btnAgain:{default:null,type:cc.Button},btnMenu:{default:null,type:cc.Button}},onLoad:function(){this.node.scale=0,cc.log(this.btnSave.interactable),this.btnSave.interactable=!1,this.savedName.node.on("text-changed",this.allowSaved.bind(this)),this.btnSave.node.on("click",this.onSaveUserName.bind(this)),this.btnMenu.node.on("click",this.onGoToMenu.bind(this)),this.btnAgain.node.on("click",this.onPlayAgain.bind(this))},start:function(){var e=this;cc.tween(this.node).to(3,{scale:1},{easing:"bounceOut"}).call(function(){e.animationTitle()}).start()},animationTitle:function(){cc.tween(this.titleOver.node).repeatForever(cc.tween(this.titleOver.node).to(1,{opacity:100}).to(.5,{opacity:255})).start()},allowSaved:function(e){""!==e.string&&(this.btnSave.interactable=!0)},onSaveUserName:function(){this.node.active=!1,i.instance.emit("save-name",this.savedName.string),i.instance.emit("changeScreen","leaderBoardScreen")},onPlayAgain:function(){this.node.active=!1,i.instance.emit("changeScreen","playScreen",!0)},onGoToMenu:function(){this.node.active=!1,i.instance.emit("changeScreen","mainScreen")}}),cc._RF.pop()},{Emitter:"Emitter"}],item:[function(e,t,n){"use strict";cc._RF.push(t,"1db81ZVMSpJoosFcI3XMJw1","item"),cc.Class({extends:cc.Component,properties:{username:cc.Label,score:cc.Label,top:cc.Label},start:function(){},setItem:function(e,t){this.username.string=e.name,this.score.string=e.score,this.top.string=t}}),cc._RF.pop()},{}],leaderBoard:[function(e,t,n){"use strict";cc._RF.push(t,"714f0AAgIVKHYdf+sRabOpK","leaderBoard");var i=e("Emitter");cc.Class({extends:cc.Component,properties:{leaderItem:{default:null,type:cc.Prefab},leaderBoard:{default:null,type:cc.ScrollView},btnMenu:{default:null,type:cc.Button}},onLoad:function(){this.loadItem(),this.btnMenu.node.on("click",this.goToMenu.bind(this))},start:function(){},goToMenu:function(){i.instance.emit("changeScreen","mainScreen")},loadItem:function(){var e=this,t=JSON.parse(cc.sys.localStorage.getItem("leaderboard"));cc.log(t),null!==t&&(t.sort(function(e,t){return e.score>t.score?-1:t.score>e.score?1:0}),t.slice(0,9),t.map(function(t,n){var i=cc.instantiate(e.leaderItem),s=i.getComponent("item");s.setItem(t,n+1),cc.log(e.leaderBoard.content),cc.log(i),e.leaderBoard.content.addChild(i,0),cc.log(s),cc.log(n)}))}}),cc._RF.pop()},{Emitter:"Emitter"}],mainScreen:[function(e,t,n){"use strict";cc._RF.push(t,"d37a4UbVWBO7aySwJVFhYV6","mainScreen");var i=e("Emitter");cc.Class({extends:cc.Component,properties:{play:cc.Button,setting:cc.Button,leaderBoard:cc.Button,settingPopup:{default:null,type:cc.Node}},onLoad:function(){this.settingPopup.active=!1,this.setting.node.on("click",this.showSetting.bind(this)),this.play.node.on("click",this.onPlay.bind(this)),this.leaderBoard.node.on("click",this.showLeaderBoard.bind(this))},start:function(){},onPlay:function(){i.instance.emit("changeScreen","playScreen",!0)},showSetting:function(){this.settingPopup.active=!0},showLeaderBoard:function(){i.instance.emit("changeScreen","leaderBoardScreen")}}),cc._RF.pop()},{Emitter:"Emitter"}],rock:[function(e,t,n){"use strict";cc._RF.push(t,"20907FEFrJPCJs/gu2v4Rzr","rock");var i=!0,s=[{r:225,g:97,b:63},{r:50,g:255,b:0},{r:39,g:105,b:231},{r:223,g:31,b:229}],o=e("Emitter");cc.Class({extends:cc.Component,properties:{score:{default:99,type:cc.Integer,serializable:!1},dir:{default:1,type:cc.Integer,serializable:!1,notify:function(){this.getRand()}},maxScale:{default:.4},_destroy:!1,_losing:{default:!1},_existTime:0},onLoad:function(){this._initScore=this.score,this.losing=this.onLosing.bind(this),o.instance.registerEvent("on-losing",this.losing),this.getRand(),this.status=i,cc.director.getCollisionManager().enabled=!0,this.getColor()},start:function(){this.onFalling()},getRand:function(){this.rand=Math.floor(100*Math.random())},setScore:function(e){this.score=e,this.node.children[0].getComponent(cc.Label).string=this.score},getColor:function(){var e=Math.floor(4*Math.random());this.node.color=new cc.Color(s[e])},onLosing:function(){this._losing=!0,this.node&&this.node.stopAllActions()},onBounce:function(){var e=this,t=(Math.random()<.5?-1:1)*this.rand;Math.abs(this.node.x)+52>=cc.winSize.width/2&&(cc.log("touch wall"),this.dir=-1*this.dir,cc.log(Math.abs(this.node.x)+":"+cc.winSize.width/2));var n=[cc.v2(0,0),cc.v2(t,300),cc.v2(t,600)],i=cc.bezierBy(2,n),s=cc.sequence(i,cc.callFunc(function(){e.status=!0,e.onFalling()}));this.node.runAction(s)},onCollisionEnter:function(e,t){if("ground"==e.node.group)this.status=!1,this.node.stopAllActions(),this.onBounce();else if("bullet"==e.node.group&&!this._destroy){var n=e.node.getComponent("bullet").getDame();this.updateScore(n),e.node.destroy()}},updateScore:function(e){this._losing||(this.maxScale<=this.node.scale&&cc.tween(this.node).by(.5,{scale:-e/(5*this.score)}).start(),this.score-=e,this.score<=0?(this._destroy=!0,this.node.children[0].getComponent(cc.Label).string=0,cc.log(this._initScore),o.instance.emit("updateProgress",this._initScore),this.onDisapper()):this.node.children[0].getComponent(cc.Label).string=this.score)},onFalling:function(){var e=(Math.random()<.5?-1:1)*this.rand,t=[cc.v2(0,0),cc.v2(e,-600),cc.v2(20*e,-1e3)],n=cc.bezierBy(3,t);this.node.runAction(n)},onDisapper:function(){var e=this;o.instance.removeEvent("on-losing",this.losing),cc.tween(this.node).to(.5,{scale:0}).call(function(){e.node.destroy()}).start()},update:function(e){this._existTime+=e,this._existTime>5&&!this._losing&&this.onDisapper()}}),cc._RF.pop()},{Emitter:"Emitter"}],settings:[function(e,t,n){"use strict";cc._RF.push(t,"1ab69B2VcpPnYIyHv5Eusyl","settings"),cc.Class({extends:cc.Component,properties:{btnClear:{default:null,type:cc.Button},btnClose:{default:null,type:cc.Button}},onLoad:function(){this.btnClose.node.on("click",this.onClose.bind(this)),this.btnClear.node.on("click",this.onClear.bind(this))},start:function(){},onClear:function(){cc.sys.localStorage.removeItem("leaderboard"),cc.log("OKAYYYYYY")},onClose:function(){this.node.active=!1}}),cc._RF.pop()},{}],tank:[function(e,t,n){"use strict";cc._RF.push(t,"604c3dX4jRBg42UMWV4zBJx","tank");var i=e("Emitter");cc.Class({extends:cc.Component,properties:{maxSpeed:0,accel:0,_losing:!1},onLoad:function(){var e=this.node.getComponent(cc.BoxCollider);e.size.width=52,e.size.height=67,this.accLeft=!1,this.accRight=!1,this.speed=0,i.instance.registerEvent("playAgain",this.onPlayAgain.bind(this)),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onMove,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onStop,this)},onMove:function(e){switch(e.keyCode){case cc.macro.KEY.a:this.accLeft=!0;break;case cc.macro.KEY.d:this.accRight=!0}},onStop:function(e){switch(e.keyCode){case cc.macro.KEY.a:this.accLeft=!1,this.speed=0;break;case cc.macro.KEY.d:this.accRight=!1,this.speed=0}},start:function(){},onCollisionEnter:function(e,t){"rock"==e.node.group&&(this.onLose(),e.node.destroy(),this._losing=!0)},onLose:function(){i.instance.emit("on-losing")},onPlayAgain:function(){this._losing=!1},directionMoving:function(e){this.accLeft&&this.node.x>-308?this.speed-=20:this.accRight&&this.node.x<308?this.speed+=20:this.speed=0,Math.abs(this.speed)>this.maxSpeed&&(this.speed=this.maxSpeed*this.speed/Math.abs(this.speed)),this.node.x+=this.speed*e},update:function(e){this._losing||this.directionMoving(e)}}),cc._RF.pop()},{Emitter:"Emitter"}]},{},["Emitter","HelloWorld","item","leaderBoard","mainScreen","settings","PlayMain","bullet","gameover","rock","tank"]);